<html>

<head>
  <meta charset="utf-8" />
</head>

<body>
  <script>
    (() => { "use strict"; const t = t => new Promise(((e, n) => { setTimeout((() => { e(void 0) }), t) })); Symbol.asyncIterator, document.createElement("div"); const e = async (n, r = {}) => { if (!Array.isArray(n)) return null === n ? [] : [document.createTextNode(String(n))]; const [o, a, ...i] = n, c = Object.entries(a).reduce(((t, [e, n]) => ("$" === e[0] && (t[e] = n), t)), { ...r }); if ("string" == typeof o) { const t = []; try { for (const n of i) t.push(...await e(n, c)) } catch (t) { if (a.errorBoundary) return [document.createTextNode(String(a.errorBoundary))]; throw t } if ("Fragment" === o) return t; const n = document.createElement(o); for (const [t, e] of Object.entries(a)) t.startsWith("on") ? n.addEventListener(t.substr(2), e) : n.setAttribute(t, String(e)); for (const e of t) n.appendChild(e); return [n] } const s = o({ ...c, ...a, children: i }); if (null === s || "object" != typeof s || Array.isArray(s)) return await e(s, c); const d = async (n, r) => { do { await t(0) } while (r && !n.isConnected); if (!n.isConnected) return void await s.return(); const o = await s.next(n); if (o.done) return; const a = await e(o.value, c); if (1 !== a.length) throw new Error(`Expect component to return single element, not ${a.length} elements`); const i = a[0]; if (i.tagName !== n.tagName) throw new Error(`Expect component to rerender with tag ${n.tagName.toLowerCase()}, not tag ${i.tagName.toLocaleLowerCase()}`); for (const t of i.getAttributeNames()) { const e = i.getAttribute(t); null !== e && n.setAttribute(t, e) } n.replaceChildren(...i.childNodes), d(n, !1) }, l = await s.next(); if (l.done) return []; const u = await e(l.value, c); if (1 !== u.length) throw new Error(`Expect component to return single node, not ${u.length} nodes`); return d(u[0], !0), u }; (async () => { document.body.replaceChildren(...await e([({ title: t, items: e }) => ["div", {}, ["div", {}, `${t} (${e.length})`], ...e.map((t => ["li", {}, t]))], { title: "Todo", items: ["Apple", "Banana", "Chocolate"] }])) })() })();
  </script>
</body>

</html>