<html>

<head>
  <meta charset="utf-8" />
</head>

<body>
  <script>
    (() => { "use strict"; const t = () => Math.random().toString(16).substr(2), e = t => new Promise(((e, n) => { setTimeout((() => { e(void 0) }), t) })), n = (() => { const t = document.createElement("div"); return e => (t.innerText = e, t.innerHTML) })(), r = (e, o = "GLOBAL", s = {}) => { if (Array.isArray(e)) { const [n, l, ...f] = e, h = (c = ([e, n]) => { if ("on" !== e.substr(0, 2)) return [e, n]; { const r = e + "-" + t(); return glob[o] = s, s[r] = t => n(t), [e, `glob['${o}']['${r}'](event)`] } }, a = (t, [e, n]) => (t[e] = n, t), i = {}, ((u = l).reduce ? u : Object.entries(u)).reduce(((t, e) => a(t, c(e))), i)), d = f.map((t => r(t, o, s))); return "Fragment" === n ? d.join("") : `<${n} ${Object.entries(h).map((([t, e]) => void 0 !== e ? `${t}="${e}"` : t)).join(" ")}>${d.join("")}</${n}>` } var a, i, c, u; return null === e ? "" : n(String(e)) }, o = async (n, s = {}) => { if (Array.isArray(n)) { const [a, i, ...c] = n, u = Object.entries(i).reduce(((t, [e, n]) => ("$" === e[0] && (t[e] = n), t)), { ...s }), l = []; try { for (const t of c) l.push(await o(t, u)) } catch (t) { if (i.errorBoundary) return i.errorBoundary; throw t } if ("string" == typeof a) return [a, i, ...l]; const f = a({ ...u, ...i, children: l }); if (null === f || "object" != typeof f || Array.isArray(f)) return await o(f, u); let h; const d = async t => { do { await e(0) } while (t && !document.getElementById(h)); const n = document.getElementById(h); if (!n) return void await f.return(); const s = await f.next(n); if (s.done) return; const a = await o(s.value, u); if (!Array.isArray(a)) throw new Error(`Expect component to rerender a tag, not ${a}`); const [i, c, ...l] = a; if (i !== n.tagName.toLowerCase()) throw new Error(`Expect component to rerender with tag ${n.tagName.toLowerCase()}, not tag ${i}`); Object.assign(n, c); const w = {}; n.innerHTML = l.map((t => r(t, h, w))).join(" "), d(!1) }, w = await f.next(); if (w.done) return null; const y = await o(w.value, u); if (!Array.isArray(y)) throw new Error(`Expect component to return a tag, not ${y}`); const [, m] = y; return h = m.id || t(), m.id = h, d(!0), y } return n }; class s { constructor(t) { this.x = t } map(t) { return new s(this.x) } } const a = (t, e) => e((t => new s(t)))(t).x; class i { constructor(t) { this.value = t, this.ref = 1, this.watchers = [], this[Symbol.asyncIterator] = async function* () { let t = this.ref; for (yield this.value; ;)t !== this.ref ? (t = this.ref, yield this.value) : await new Promise((t => { this.watchers.push(t) })) } } async notify(t) { const e = "function" == typeof t ? t(this.value) : t; if (e !== this.value) { this.value = e, this.ref += 1; for (const t of this.watchers.splice(0, this.watchers.length)) t(void 0) } } focus(...t) { const e = this; let n = []; return { [Symbol.asyncIterator]: async function* () { for await (const r of e) { const e = t.map((t => a(r, t))); (e.length !== n.length || e.some(((t, e) => t !== n[e]))) && (n = e, yield r) } } } } } Symbol.asyncIterator, (async () => { const t = (t, ...e) => { const n = new Set(t); for (const t of e) n.delete(t); return n }, n = async () => (await e(42), ["Apples", "Bananas", "Chocolate"]), s = new i({ selected: new Set(["Bananas"]) }); window.glob = {}, document.body.innerHTML = r(await o([async function* ({ stateOb: e }) { const r = n => e.notify((e => ({ ...e, selected: e.selected.has(n) ? t(e.selected, n) : new Set([...e.selected, n]) }))); for await (const { selected: t } of e) { if (!t) return; const e = await n(); yield ["div", {}, ["ul", {}, ...e.map((e => ["li", { style: t.has(e) ? "font-weight: bold;" : "", onclick: () => r(e) }, e]))]] } }, { stateOb: s }])) })() })();
  </script>
</body>

</html>